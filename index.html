<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‚ö° Energy Dashboard - Login</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      max-width: 450px;
      width: 100%;
      padding: 40px;
    }

    .logo {
      text-align: center;
      margin-bottom: 30px;
    }

    .logo-icon {
      font-size: 4em;
      margin-bottom: 10px;
    }

    h1 {
      color: #667eea;
      font-size: 1.8em;
      text-align: center;
      margin-bottom: 10px;
    }

    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
      font-size: 0.95em;
    }

    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 25px;
      border-bottom: 2px solid #e0e0e0;
    }

    .tab {
      flex: 1;
      padding: 12px;
      border: none;
      background: none;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      color: #999;
      border-bottom: 3px solid transparent;
      transition: all 0.3s;
    }

    .tab.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #555;
      font-weight: 500;
      font-size: 0.95em;
    }

    .form-group input {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 0.95em;
      transition: border 0.3s;
    }

    .form-group input:focus {
      outline: none;
      border-color: #667eea;
    }

    .btn {
      width: 100%;
      padding: 14px;
      border: none;
      border-radius: 8px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      margin-bottom: 15px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-google {
      background: white;
      color: #333;
      border: 2px solid #e0e0e0;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .btn-google:hover {
      background: #f8f9fa;
      border-color: #667eea;
    }

    .google-icon {
      width: 20px;
      height: 20px;
    }

    .divider {
      text-align: center;
      margin: 25px 0;
      position: relative;
    }

    .divider::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      width: 100%;
      height: 1px;
      background: #e0e0e0;
    }

    .divider span {
      background: white;
      padding: 0 15px;
      color: #999;
      font-size: 0.9em;
      position: relative;
      z-index: 1;
    }

    .alert {
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 15px;
      font-size: 0.9em;
    }

    .alert-error {
      background: #f8d7da;
      color: #721c24;
      border-left: 4px solid #dc3545;
    }

    .alert-success {
      background: #d4edda;
      color: #155724;
      border-left: 4px solid #28a745;
    }

    .alert-info {
      background: #d1ecf1;
      color: #0c5460;
      border-left: 4px solid #17a2b8;
    }

    .info-box {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 0.9em;
      color: #555;
    }

    .info-box strong {
      color: #333;
    }

    .footer-links {
      text-align: center;
      margin-top: 20px;
      font-size: 0.9em;
    }

    .footer-links a {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
    }

    .footer-links a:hover {
      text-decoration: underline;
    }

    .loading {
      text-align: center;
      padding: 20px;
    }

    .spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #667eea;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 10px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .hidden {
      display: none;
    }

    @media (max-width: 600px) {
      .container {
        padding: 30px 25px;
      }

      h1 {
        font-size: 1.5em;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo">
      <div class="logo-icon">‚ö°</div>
      <h1>Energy Dashboard</h1>
      <p class="subtitle">‡∏£‡∏∞‡∏ö‡∏ö‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</p>
    </div>

    <!-- Alert Container -->
    <div id="alertContainer"></div>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab active" onclick="switchTab('login')">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      <button class="tab" onclick="switchTab('register')">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</button>
    </div>

    <!-- Login Tab -->
    <div id="login-tab" class="tab-content active">
      <!-- Google Sign-in Button -->
      <button class="btn btn-google" onclick="signInWithGoogle()">
        <svg class="google-icon" viewBox="0 0 24 24">
          <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
          <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
          <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
          <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
        </svg>
        ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Google
      </button>

      <div class="divider">
        <span>‡∏´‡∏£‡∏∑‡∏≠</span>
      </div>

      <!-- Email/Password Login -->
      <form id="loginForm" onsubmit="loginWithEmail(event)">
        <div class="form-group">
          <label for="loginEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
          <input 
            type="email" 
            id="loginEmail" 
            placeholder="your@email.com" 
            required
          >
        </div>

        <div class="form-group">
          <label for="loginPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
          <input 
            type="password" 
            id="loginPassword" 
            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
            required
          >
        </div>

        <button type="submit" class="btn btn-primary">
          ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
        </button>
      </form>
    </div>

    <!-- Register Tab -->
    <div id="register-tab" class="tab-content">
      <div class="info-box">
        <strong>üìù ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô:</strong><br>
        1. ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Email ‡∏´‡∏£‡∏∑‡∏≠ Google<br>
        2. ‡∏£‡∏≠ Admin ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 5-10 ‡∏ô‡∏≤‡∏ó‡∏µ)<br>
        3. ‡∏£‡∏±‡∏ö QR Code ‡∏à‡∏≤‡∏Å Admin<br>
        4. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!
      </div>

      <!-- Google Sign-in Button -->
      <button class="btn btn-google" onclick="registerWithGoogle()">
        <svg class="google-icon" viewBox="0 0 24 24">
          <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
          <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
          <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
          <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
        </svg>
        ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Google
      </button>

      <div class="divider">
        <span>‡∏´‡∏£‡∏∑‡∏≠</span>
      </div>

      <!-- Email/Password Register -->
      <form id="registerForm" onsubmit="registerWithEmail(event)">
        <div class="form-group">
          <label for="registerName">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
          <input 
            type="text" 
            id="registerName" 
            placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"
          >
        </div>

        <div class="form-group">
          <label for="registerEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
          <input 
            type="email" 
            id="registerEmail" 
            placeholder="your@email.com" 
            required
          >
        </div>

        <div class="form-group">
          <label for="registerPassword">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 6 ‡∏ï‡∏±‡∏ß)</label>
          <input 
            type="password" 
            id="registerPassword" 
            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
            required
            minlength="6"
          >
        </div>

        <button type="submit" class="btn btn-primary">
          ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
        </button>
      </form>
    </div>

    <!-- Footer Links -->
    <div class="footer-links">
      <a href="admin.html">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Admin</a>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

  <script>
    // ========================================
    // CONFIGURATION
    // ========================================
    
    const CONFIG = {
      firebase: {
        apiKey: "AIzaSyCK-pRuG2UBYzbzyg6NEoJqFeM9bVokKsU",
  	authDomain: "energy-dashboard-3phase.firebaseapp.com",
  	projectId: "energy-dashboard-3phase",
  	storageBucket: "energy-dashboard-3phase.firebasestorage.app",
  	messagingSenderId: "538942868301",
  	appId: "1:538942868301:web:e5075552648f5135a24504"
      },
      apiUrl: "https://script.google.com/macros/s/AKfycbyGkHgRv34rmHt0_SpMuBJALDkhxz48F5QZbaBrG6JHB2QspLga_vJXhx6zpA-cueb8yQ/exec"
    };

    // Initialize Firebase
    firebase.initializeApp(CONFIG.firebase);
    const auth = firebase.auth();
    const googleProvider = new firebase.auth.GoogleAuthProvider();

    // ========================================
    // TAB MANAGEMENT
    // ========================================

    function switchTab(tabName) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });

      // Remove active from all buttons
      document.querySelectorAll('.tab').forEach(btn => {
        btn.classList.remove('active');
      });

      // Show selected tab
      document.getElementById(tabName + '-tab').classList.add('active');
      event.target.classList.add('active');

      // Clear alert
      document.getElementById('alertContainer').innerHTML = '';
    }

    // ========================================
    // EMAIL/PASSWORD AUTHENTICATION
    // ========================================

    async function loginWithEmail(event) {
      event.preventDefault();
      
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;

      try {
        const userCredential = await auth.signInWithEmailAndPassword(email, password);
        const token = await userCredential.user.getIdToken();

        // Verify token and check status
        const url = `${CONFIG.apiUrl}?action=verifyToken&token=${token}`;
        const response = await fetch(url);
        const data = await response.json();

        if (!data.success) {
          if (data.status === 'pending') {
            showAlert('info', '‚è≥ ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Admin ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà');
            await auth.signOut();
          } else if (data.status === 'rejected') {
            showAlert('error', '‚ùå ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Admin');
            await auth.signOut();
          } else {
            showAlert('error', data.error);
            await auth.signOut();
          }
          return;
        }

        // Check if user is admin
        if (data.user.email && isAdminEmail(data.user.email)) {
          window.location.href = 'admin.html';
        } else {
          window.location.href = 'settings.html';
        }

      } catch (error) {
        console.error('Login error:', error);
        showAlert('error', getErrorMessage(error.code));
      }
    }

    async function registerWithEmail(event) {
      event.preventDefault();
      
      const email = document.getElementById('registerEmail').value;
      const password = document.getElementById('registerPassword').value;
      const displayName = document.getElementById('registerName').value;

      try {
        // Create user in Firebase
        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
        
        // Update profile if name provided
        if (displayName) {
          await userCredential.user.updateProfile({ displayName: displayName });
        }

        const token = await userCredential.user.getIdToken();

        // Register in backend
        const url = `${CONFIG.apiUrl}?action=registerUser&token=${token}&email=${encodeURIComponent(email)}&displayName=${encodeURIComponent(displayName || '')}&provider=password`;
        const response = await fetch(url);
        const data = await response.json();

        if (data.success) {
          showAlert('success', '‚úÖ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Admin (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 5-10 ‡∏ô‡∏≤‡∏ó‡∏µ)');
          
          // Sign out and switch to login tab
          await auth.signOut();
          
          setTimeout(() => {
            switchTab('login');
            document.getElementById('loginEmail').value = email;
          }, 3000);
        } else {
          showAlert('error', data.error);
          // Delete Firebase user if backend registration failed
          await userCredential.user.delete();
        }

      } catch (error) {
        console.error('Register error:', error);
        showAlert('error', getErrorMessage(error.code));
      }
    }

    // ========================================
    // GOOGLE AUTHENTICATION
    // ========================================

    async function signInWithGoogle() {
      try {
        const result = await auth.signInWithPopup(googleProvider);
        const token = await result.user.getIdToken();

        // Check if user exists in backend
        const verifyUrl = `${CONFIG.apiUrl}?action=verifyToken&token=${token}`;
        const verifyResponse = await fetch(verifyUrl);
        const verifyData = await verifyResponse.json();

        if (verifyData.success) {
          // User exists and approved
          if (isAdminEmail(result.user.email)) {
            window.location.href = 'admin.html';
          } else {
            window.location.href = 'settings.html';
          }
        } else if (verifyData.needsRegistration) {
          // User doesn't exist - show error
          showAlert('error', '‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Å‡πà‡∏≠‡∏ô');
          await auth.signOut();
        } else if (verifyData.status === 'pending') {
          showAlert('info', '‚è≥ ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Admin');
          await auth.signOut();
        } else if (verifyData.status === 'rejected') {
          showAlert('error', '‚ùå ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ Admin');
          await auth.signOut();
        } else {
          showAlert('error', verifyData.error);
          await auth.signOut();
        }

      } catch (error) {
        console.error('Google sign-in error:', error);
        if (error.code !== 'auth/popup-closed-by-user') {
          showAlert('error', getErrorMessage(error.code));
        }
      }
    }

    async function registerWithGoogle() {
      try {
        const result = await auth.signInWithPopup(googleProvider);
        const token = await result.user.getIdToken();

        // Register in backend
        const url = `${CONFIG.apiUrl}?action=registerUser&token=${token}&email=${encodeURIComponent(result.user.email)}&displayName=${encodeURIComponent(result.user.displayName || '')}&provider=google.com`;
        const response = await fetch(url);
        const data = await response.json();

        if (data.success) {
          showAlert('success', '‚úÖ ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Admin (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 5-10 ‡∏ô‡∏≤‡∏ó‡∏µ)');
          
          await auth.signOut();
          
          setTimeout(() => {
            switchTab('login');
          }, 3000);
        } else {
          if (data.error.includes('already registered')) {
            showAlert('info', 'üìß ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö');
            switchTab('login');
          } else {
            showAlert('error', data.error);
          }
          await auth.signOut();
        }

      } catch (error) {
        console.error('Google register error:', error);
        if (error.code !== 'auth/popup-closed-by-user') {
          showAlert('error', getErrorMessage(error.code));
        }
      }
    }

    // ========================================
    // UTILITY FUNCTIONS
    // ========================================

    function isAdminEmail(email) {
      const adminEmails = [
        'pwaenergryiot@gmail.com', // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏≤‡∏° CONFIG ‡πÉ‡∏ô Backend
        'saantie@gmail.com'
      ];
      return adminEmails.includes(email.toLowerCase());
    }

    function getErrorMessage(errorCode) {
      const errors = {
        'auth/email-already-in-use': '‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß',
        'auth/invalid-email': '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
        'auth/operation-not-allowed': '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ',
        'auth/weak-password': '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 6 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£',
        'auth/user-disabled': '‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô',
        'auth/user-not-found': '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ô‡∏µ‡πâ',
        'auth/wrong-password': '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
        'auth/too-many-requests': '‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏≤‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á',
        'auth/network-request-failed': '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢'
      };
      
      return errors[errorCode] || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + errorCode;
    }

    function showAlert(type, message) {
      const container = document.getElementById('alertContainer');
      const alertClass = type === 'success' ? 'alert-success' : 
                         type === 'error' ? 'alert-error' : 'alert-info';
      
      container.innerHTML = `
        <div class="alert ${alertClass}">
          ${message}
        </div>
      `;
    }

    // ========================================
    // AUTO-LOGIN CHECK
    // ========================================

    auth.onAuthStateChanged(async (user) => {
      if (user) {
        // User is logged in, check status
        const token = await user.getIdToken();
        const url = `${CONFIG.apiUrl}?action=verifyToken&token=${token}`;
        const response = await fetch(url);
        const data = await response.json();

        if (data.success) {
          // Redirect to appropriate page
          if (isAdminEmail(user.email)) {
            window.location.href = 'admin.html';
          } else {
            window.location.href = 'settings.html';
          }
        }
      }
    });
  </script>
</body>
</html>
